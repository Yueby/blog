<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>使用PowerShell批量重命名文件的实用技巧</title>
      <link href="/2024/12/15/powershell-rename-files/"/>
      <url>/2024/12/15/powershell-rename-files/</url>
      
        <content type="html"><![CDATA[<h1 id="PowerShell-批量重命名文件的实用技巧"><a href="#PowerShell-批量重命名文件的实用技巧" class="headerlink" title="PowerShell 批量重命名文件的实用技巧"></a>PowerShell 批量重命名文件的实用技巧</h1><p>在日常工作中,批量重命名文件是一个常见需求。使用 PowerShell 可以轻松实现这个任务,本文将介绍几种实用的重命名方法。</p><h2 id="基础语法说明"><a href="#基础语法说明" class="headerlink" title="基础语法说明"></a>基础语法说明</h2><p>PowerShell 中进行文件重命名主要用到以下 cmdlet:</p><ul><li><code>Get-ChildItem</code>(别名:<code>dir</code>) - 获取文件列表</li><li><code>Rename-Item</code>(别名:<code>ren</code>) - 重命名文件</li><li><code>Where-Object</code>(别名:<code>?</code>) - 过滤条件</li><li><code>ForEach-Object</code>(别名:<code>%</code>) - 循环处理</li></ul><h2 id="常用重命名示例"><a href="#常用重命名示例" class="headerlink" title="常用重命名示例"></a>常用重命名示例</h2><h3 id="1-替换文件名中的字符"><a href="#1-替换文件名中的字符" class="headerlink" title="1. 替换文件名中的字符"></a>1. 替换文件名中的字符</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将文件名中的 &quot;old&quot; 替换为 &quot;new&quot;</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name <span class="operator">-replace</span> <span class="string">&#x27;old&#x27;</span>,<span class="string">&#x27;new&#x27;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个命令会递归搜索当前目录下所有的.txt 文件，将文件名中的”old”替换为”new”。</p><ul><li><code>-Recurse</code> 表示包含所有子目录</li><li><code>-replace</code> 是 PowerShell 的字符串替换操作符</li><li><code>$_.Name</code> 表示当前文件的名称</li></ul><h3 id="2-添加序号前缀"><a href="#2-添加序号前缀" class="headerlink" title="2. 添加序号前缀"></a>2. 添加序号前缀</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为文件添加序号前缀(01,02,03...)</span></span><br><span class="line"><span class="variable">$i</span>=<span class="number">1</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="string">&#x27;&#123;0:d2&#125;_&#123;1&#125;&#x27;</span> <span class="operator">-f</span> <span class="variable">$i</span>++, <span class="variable">$_</span>.Name &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个命令会为所有.txt 文件添加两位数的序号前缀：</p><ul><li><code>$i=1</code> 初始化计数器</li><li><code>&#123;0:d2&#125;</code> 表示将第一个参数格式化为两位数字(如 01,02 等)</li><li><code>$i++</code> 每处理一个文件自动加 1</li><li><code>_</code> 作为序号和原文件名之间的分隔符</li></ul><h3 id="3-修改文件扩展名"><a href="#3-修改文件扩展名" class="headerlink" title="3. 修改文件扩展名"></a>3. 修改文件扩展名</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将.txt文件改为.log</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name <span class="operator">-replace</span> <span class="string">&#x27;\.txt$&#x27;</span>,<span class="string">&#x27;.log&#x27;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个命令将所有.txt 文件的扩展名改为.log：</p><ul><li><code>\.txt$</code> 是正则表达式，表示文件名末尾的.txt</li><li><code>$</code> 确保只匹配文件名末尾的.txt</li><li><code>\.</code> 中的反斜杠用于转义点号，因为点号在正则表达式中有特殊含义</li></ul><h3 id="4-删除文件名中的特定字符"><a href="#4-删除文件名中的特定字符" class="headerlink" title="4. 删除文件名中的特定字符"></a>4. 删除文件名中的特定字符</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除文件名中的空格</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name <span class="operator">-replace</span> <span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个命令删除文件名中的所有空格：</p><ul><li><code>-replace &#39; &#39;,&#39;&#39;</code> 将空格替换为空字符串</li><li>可以替换任何不需要的字符，不仅限于空格</li></ul><h3 id="5-转换大小写"><a href="#5-转换大小写" class="headerlink" title="5. 转换大小写"></a>5. 转换大小写</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换为小写</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name.ToLower() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为大写</span></span><br><span class="line"><span class="built_in">dir</span> <span class="literal">-Recurse</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name.ToUpper() &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这两个命令分别将文件名转换为小写或大写：</p><ul><li><code>ToLower()</code> 将字符串转换为小写</li><li><code>ToUpper()</code> 将字符串转换为大写</li><li>这些是.NET 字符串方法，可以直接在 PowerShell 中使用</li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>在执行批量重命名前,建议先使用<code>-WhatIf</code>参数测试:</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dir</span> | <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name.ToUpper() &#125; <span class="literal">-WhatIf</span></span><br></pre></td></tr></table></figure><ol start="2"><li>重命名时注意避免文件名冲突</li><li>使用<code>-Recurse</code>参数时要小心,它会影响子文件夹中的文件</li><li>建议在重要文件操作前先备份</li></ol><h2 id="高级技巧"><a href="#高级技巧" class="headerlink" title="高级技巧"></a>高级技巧</h2><h3 id="使用正则表达式"><a href="#使用正则表达式" class="headerlink" title="使用正则表达式"></a>使用正则表达式</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用正则表达式提取部分文件名</span></span><br><span class="line"><span class="built_in">dir</span> | ? name <span class="operator">-Match</span> <span class="string">&quot;(\d&#123;4&#125;)-.*\.txt&quot;</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="variable">$_</span>.Name <span class="operator">-replace</span> <span class="string">&quot;(\d&#123;4&#125;)-.*\.txt&quot;</span>,<span class="string">&#x27;$1.txt&#x27;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="批量处理特定日期的文件"><a href="#批量处理特定日期的文件" class="headerlink" title="批量处理特定日期的文件"></a>批量处理特定日期的文件</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重命名最近7天修改的文件</span></span><br><span class="line"><span class="variable">$date</span> = (<span class="built_in">Get-Date</span>).AddDays(<span class="literal">-7</span>)</span><br><span class="line"><span class="built_in">dir</span> | ? LastWriteTime <span class="operator">-gt</span> <span class="variable">$date</span> | % &#123;</span><br><span class="line">    <span class="built_in">ren</span> <span class="literal">-NewName</span> &#123; <span class="string">&quot;new_&quot;</span> + <span class="variable">$_</span>.Name &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>PowerShell 提供了强大而灵活的文件重命名功能,通过组合不同的 cmdlet 和参数,我们可以实现各种复杂的重命名需求。在使用时要注意测试和备份,避免误操作导致文件丢失。</p><p>希望本文介绍的这些方法能帮助你更高效地处理文件重命名工作!</p>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PowerShell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一次使用 Hexo</title>
      <link href="/2024/12/14/first-use-hexo/"/>
      <url>/2024/12/14/first-use-hexo/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作为一名游戏开发者，我一直想要一个自己的博客来记录学习心得。经过对比多个博客框架后，最终选择了 Hexo 作为我的博客框架。这篇文章记录一下我使用 Hexo 搭建博客的过程。</p><h2 id="为什么选择-Hexo？"><a href="#为什么选择-Hexo？" class="headerlink" title="为什么选择 Hexo？"></a>为什么选择 Hexo？</h2><ol><li><strong>简单易用</strong>：Hexo 的安装和使用都很简单，对于像我这样主要专注于游戏开发的开发者来说很友好</li><li><strong>Markdown 支持</strong>：可以使用 Markdown 语法写文章，这对于写技术博客很方便</li><li><strong>主题丰富</strong>：有很多优秀的主题可以选择</li><li><strong>部署方便</strong>：可以轻松部署到各种平台</li></ol><h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><ol><li>首先需要安装 Node.js</li><li>然后通过 npm 全局安装 Hexo：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><ol start="3"><li>创建一个新的 Hexo 项目：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init my-blog</span><br><span class="line"><span class="built_in">cd</span> my-blog</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">&quot;post-name&quot;</span> <span class="comment"># 创建新文章</span></span><br><span class="line">hexo generate <span class="comment"># 生成静态文件</span></span><br><span class="line">hexo server <span class="comment"># 启动本地服务器</span></span><br><span class="line">hexo deploy <span class="comment"># 部署到远程服务器</span></span><br></pre></td></tr></table></figure><h3 id="文章编写"><a href="#文章编写" class="headerlink" title="文章编写"></a>文章编写</h3><p>文章都在 <code>source/_posts</code> 目录下，使用 Markdown 格式编写。</p><h2 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h2><p>我选择了 cactus 主题，主要是因为它简洁大方。安装主题的步骤：</p><ol><li>在博客根目录下克隆主题：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/probberechts/hexo-theme-cactus.git themes/cactus</span><br></pre></td></tr></table></figure><ol start="2"><li>修改博客根目录下的 <code>_config.yml</code>，将主题设置为 cactus：</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># theme: landscape</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">cactus</span></span><br></pre></td></tr></table></figure><ol start="3"><li>主题提供了多种配色方案可选：</li></ol><ul><li>dark（深色）</li><li>light（浅色）</li><li>white（白色）</li><li>classic（经典）</li></ul><p>可以在主题配置文件中设置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">colorscheme:</span> <span class="string">light</span> <span class="comment"># 选择你喜欢的配色方案</span></span><br></pre></td></tr></table></figure><ol start="4"><li>配置导航菜单，在主题配置文件中设置：</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nav:</span></span><br><span class="line">    <span class="attr">home:</span> <span class="string">/</span></span><br><span class="line">    <span class="attr">about:</span> <span class="string">/about/</span></span><br><span class="line">    <span class="attr">articles:</span> <span class="string">/archives/</span></span><br><span class="line">    <span class="attr">projects:</span> <span class="string">http://github.com/你的用户名</span></span><br></pre></td></tr></table></figure><ol start="5"><li>添加社交媒体链接：</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social_links:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">icon:</span> <span class="string">github</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://github.com/你的用户名</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">icon:</span> <span class="string">twitter</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://twitter.com/你的用户名</span></span><br></pre></td></tr></table></figure><ol start="6"><li>如果需要启用搜索功能，需要先安装搜索插件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><p>然后创建搜索页面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page search</span><br></pre></td></tr></table></figure><p>在新创建的 <code>source/search/index.md</code> 中添加：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: Search</span><br><span class="line">type: search</span><br><span class="line"></span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>最后在导航菜单中添加搜索链接：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nav:</span></span><br><span class="line">    <span class="attr">search:</span> <span class="string">/search/</span></span><br></pre></td></tr></table></figure><p>主题的详细配置选项可以参考 <a href="https://github.com/probberechts/hexo-theme-cactus">cactus 主题文档</a>。</p><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><ol><li><strong>导航栏显示异常</strong>：使用 cactus 主题时，页面向下滚动导航栏会隐藏，但滚动回顶部时导航栏不会自动显示出来。</li></ol><p>解决方案：修改 <code>themes/cactus/source/js/main.js</code> 文件中的滚动监听代码。将：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> topDistance = menu.<span class="title function_">offset</span>().<span class="property">top</span>;</span><br></pre></td></tr></table></figure><p>改为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> topDistance = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span>;</span><br></pre></td></tr></table></figure><p>这个修改解决了导航栏的显示问题，现在可以正常根据滚动位置显示&#x2F;隐藏导航栏了。</p><p>原因分析：原代码使用 <code>menu.offset().top</code> 获取菜单距离顶部的距离，但这个值在某些情况下可能不准确。改用 <code>document.documentElement.scrollTop</code> 直接获取页面的滚动位置会更可靠。</p><h2 id="后续计划"><a href="#后续计划" class="headerlink" title="后续计划"></a>后续计划</h2><ol><li>优化博客样式</li><li>添加更多功能</li><li>持续更新游戏开发相关的技术文章</li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Hexo 确实是一个很好的博客框架，虽然刚开始使用可能会遇到一些问题，但整体来说还是很顺利的。希望这个博客能够帮助我更好地记录和分享游戏开发的经验。</p><hr><p>如果你也想搭建自己的博客，欢迎参考我的经验，有任何问题都可以通过评论区或者联系方式找我交流。</p>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerShell批量压缩文件：内置命令vs 7-Zip方案对比</title>
      <link href="/2024/12/14/powershell-create-multiple-zip/"/>
      <url>/2024/12/14/powershell-create-multiple-zip/</url>
      
        <content type="html"><![CDATA[<h1 id="PowerShell-批量创建压缩包"><a href="#PowerShell-批量创建压缩包" class="headerlink" title="PowerShell 批量创建压缩包"></a>PowerShell 批量创建压缩包</h1><p>在日常工作中，我们可能需要将多个文件分别打包成独立的压缩文件。这里介绍两种方法：使用 PowerShell 内置命令和使用 7-Zip 来实现。</p><h2 id="方法一：使用-PowerShell-内置命令"><a href="#方法一：使用-PowerShell-内置命令" class="headerlink" title="方法一：使用 PowerShell 内置命令"></a>方法一：使用 PowerShell 内置命令</h2><p>使用 PowerShell 的<code>Compress-Archive</code>命令可以直接实现压缩功能：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Path</span> <span class="string">&quot;C:\源文件夹&quot;</span> <span class="operator">-File</span> | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="built_in">Compress-Archive</span> <span class="literal">-Path</span> <span class="variable">$_</span>.FullName <span class="literal">-DestinationPath</span> <span class="string">&quot;C:\目标文件夹\<span class="variable">$</span>(<span class="variable">$_</span>.BaseName).zip&quot;</span> <span class="literal">-Force</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="代码说明"><a href="#代码说明" class="headerlink" title="代码说明"></a>代码说明</h3><ul><li><code>Get-ChildItem</code>: 获取指定路径下的所有文件</li><li><code>-Path</code>: 指定源文件夹路径</li><li><code>-File</code>: 只获取文件，不包括文件夹</li><li><code>ForEach-Object</code>: 对每个文件执行压缩操作</li><li><code>Compress-Archive</code>: PowerShell 的压缩命令</li><li><code>-Force</code>: 如果目标 zip 文件已存在，则覆盖它</li></ul><h2 id="方法二：使用-7-Zip"><a href="#方法二：使用-7-Zip" class="headerlink" title="方法二：使用 7-Zip"></a>方法二：使用 7-Zip</h2><p>如果需要更多压缩选项或更好的压缩率，可以使用 7-Zip：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> *.unitypackage | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    &amp;<span class="string">&quot;E:\7-Zip\7z.exe&quot;</span> a <span class="literal">-tzip</span> <span class="string">&quot;<span class="variable">$</span>(<span class="variable">$_</span>.BaseName).zip&quot;</span> <span class="variable">$_</span>.Name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="代码说明-1"><a href="#代码说明-1" class="headerlink" title="代码说明"></a>代码说明</h3><ul><li><code>Get-ChildItem *.unitypackage</code>: 获取当前目录下所有 .unitypackage 文件</li><li><code>&amp;&quot;E:\7-Zip\7z.exe&quot;</code>: 调用 7-Zip 程序（需要根据实际安装路径调整）</li><li><code>a</code>: 添加文件到压缩包</li><li><code>-tzip</code>: 指定压缩格式为 zip</li><li><code>$($_.BaseName).zip</code>: 使用原文件名（不含扩展名）作为 zip 文件名</li><li><code>$_.Name</code>: 要压缩的源文件名</li></ul><p>也可以使用更简短的命令形式：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dir</span> | ? name <span class="operator">-Like</span> <span class="string">&quot;*.unitypackage&quot;</span> | % &#123;</span><br><span class="line">    &amp;<span class="string">&quot;E:\7-Zip\7z.exe&quot;</span> a <span class="literal">-tzip</span> <span class="string">&quot;<span class="variable">$</span>(<span class="variable">$_</span>.BaseName).zip&quot;</span> <span class="variable">$_</span>.Name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用注意事项"><a href="#使用注意事项" class="headerlink" title="使用注意事项"></a>使用注意事项</h2><ol><li>确保有足够的磁盘空间</li><li>路径中避免特殊字符</li><li>确保具有相应文件夹的访问权限</li><li>使用 7-Zip 方法时，需要先安装 7-Zip 并确保路径正确</li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这两种方法各有特点：</p><ul><li>PowerShell 内置命令使用简单，无需额外软件</li><li>7-Zip 方法提供更多压缩选项，压缩率通常更好</li></ul><p>根据实际需求选择合适的方法即可。</p>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PowerShell </tag>
            
            <tag> 7-Zip </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
